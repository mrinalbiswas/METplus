

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. Instructions for the Conda Environment &mdash; METplus 4.0.0-beta3 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://dtcenter.github.io/METplus/latest/Contributors_Guide/conda_env.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="METplus 4.0.0-beta3 documentation" href="../index.html"/>
        <link rel="up" title="Contributor’s Guide" href="index.html"/>
        <link rel="next" title="5. Deprecating an Old Config Variable" href="deprecation.html"/>
        <link rel="prev" title="3. How to Create Your Own Wrapper" href="create_wrapper.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> METplus
          

          
            
            <img src="../_static/METplus_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>develop</option>
                      
                        
                          <option value="../latest">latest</option>
                        
                      
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">METplus Wrappers Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Users_Guide/index.html">User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributor’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coding_standards.html">1. Coding Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_components.html">2. Basic Components of METplus Python Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_wrapper.html">3. How to Create Your Own Wrapper</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4. Instructions for the Conda Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview-replicating-the-python-3-6-3-environment-for-running-metplus">4.1. Overview:  Replicating the Python 3.6.3 environment for running METplus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-condition-installing-the-conda-package-manager-if-it-doesn-t-exist">4.2. Pre-condition- installing the conda package manager if it doesn’t exist</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-metplus-conda-env">4.3. Creating the METplus conda env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activating-and-deactivating-the-metplus-conda-env">4.4. Activating and deactivating the METplus conda env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-checking-for-missing-packages-and-mismatched-version">4.5. Optional: Checking for missing packages and mismatched version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deprecation.html">5. Deprecating an Old Config Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="github_workflow.html">6. GitHub Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">7. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_use_case.html">8. Adding Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html">9. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Release_Guide/index.html">Release Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Verification_Datasets/index.html">Verification Datasets Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METplus</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Contributor’s Guide</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Instructions for the Conda Environment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Contributors_Guide/conda_env.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="instructions-for-the-conda-environment">
<span id="conda-env"></span><h1><span class="section-number">4. </span>Instructions for the Conda Environment<a class="headerlink" href="#instructions-for-the-conda-environment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-replicating-the-python-3-6-3-environment-for-running-metplus">
<h2><span class="section-number">4.1. </span>Overview:  Replicating the Python 3.6.3 environment for running METplus<a class="headerlink" href="#overview-replicating-the-python-3-6-3-environment-for-running-metplus" title="Permalink to this headline">¶</a></h2>
<p>If the host (i.e. the computer on which the METplus and MET tools are
running) doesn’t already have all the necessary packages installed, it is
recommend that METplus be run within a conda environment. This enables
the user to manage dependencies and to isolate the METplus version
of Python from other Python applications.</p>
<p>To replicate the packages used in the development of METplus, use the
environment.yml file to recreate the Python environment used by METplus.
This file is found at the top-level dirctory of the
METplus source code:</p>
<blockquote>
<div><p><em>METplus/environment.yml</em></p>
</div></blockquote>
</div>
<div class="section" id="pre-condition-installing-the-conda-package-manager-if-it-doesn-t-exist">
<h2><span class="section-number">4.2. </span>Pre-condition- installing the conda package manager if it doesn’t exist<a class="headerlink" href="#pre-condition-installing-the-conda-package-manager-if-it-doesn-t-exist" title="Permalink to this headline">¶</a></h2>
<p><strong>These instructions only need to be followed once.</strong></p>
<ol class="arabic">
<li><p>First, download <strong>miniconda3</strong> from the
<a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda/Continuum Analytics
website</a>
(this is a minimal installer that contains the package manager,
<em>conda</em> that has Python 3 and other dependent packages.)</p>
<p>If it doesn’t exist on the computer, download it <a class="reference external" href="https://conda.io/en/latest/miniconda.html">here</a>.</p>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="2">
<li><p>Select the appropriate Python 3.7 (or newer) version for the operating
system and computer’s architecture.</p>
<p>Follow the <a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/install/index.html">installation instructions</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be worth considering changing the default installation location to a partition with more space.</p>
</div>
<p>From the command line, enter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">df -h</span>
</pre></div>
</div>
<p>to see how much space is available on the disk partitions on the computer/host.</p>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="3">
<li><p>When queried whether to run initialization:</p>
<p><em>Do you wish the installer to initialize Miniconda3 by running conda init?</em></p>
<p>Enter ‘yes’.  This allows <em>conda</em> to append the user’s .bashrc file so that
when the bash shell is invoked, the user will automatically be placed in
a conda ‘base’ environment.  This base environment is a very simple,
minimal environment that has Python 3.7 (or whatever version of Python 3 that
has been selected in step 2 above) and a few other basic Python packages.
From this base environment, the user can readily activate other conda
envs.  For instance, if the user is working on a project that uses
Python 3.5, and another project that requires Python 3.6, the user can
create two conda envs, one for Python 3.5 and the other for Python 3.6
and simply activate and work within the desired conda env.</p>
</li>
</ol>
</div>
<div class="section" id="creating-the-metplus-conda-env">
<h2><span class="section-number">4.3. </span>Creating the METplus conda env<a class="headerlink" href="#creating-the-metplus-conda-env" title="Permalink to this headline">¶</a></h2>
<p><strong>These instructions only need to be implemented once.</strong></p>
<p>After the METplus conda env has been created, activate the
conda env to run the METplus applications and deactivate the conda env
to end the application.</p>
<ol class="arabic">
<li><p>Start up the base environment by changing to the bash shell.  It will
look  something like this:</p>
<p><em>(base)username&#64;host:</em></p>
<p>where the (base) indicates that the user is in the base conda
environment which contains the basic packages for the version of
Python (corresponding to the miniconda3 installation).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user’s prompt may vary, based on how the system administrator set up the account.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p>Recreate the Python 3.x environment used for METplus via the
environment.yml file found in the repository under the METplus directory:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conda env create -f environment.yml</span>
</pre></div>
</div>
<p>This may take a few minutes to install all the packages specified
in the environment.yml file.</p>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="3">
<li><p>Activate the environment.  From the (base) prompt, enter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conda activate name-of-env</span>
</pre></div>
</div>
<p>where name-of-env is found at the top of the environment.yml file</p>
<blockquote>
<div><p>e.g. <em>mini3.6.3</em></p>
</div></blockquote>
</li>
<li><p>Run the METplus applications in this conda env.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p>When finished, deactivate the environment:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conda deactivate</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="activating-and-deactivating-the-metplus-conda-env">
<h2><span class="section-number">4.4. </span>Activating and deactivating the METplus conda env<a class="headerlink" href="#activating-and-deactivating-the-metplus-conda-env" title="Permalink to this headline">¶</a></h2>
<p>Once the user has followed the instructions under the “Creating the METplus
conda env”, follow these instructions to start running METplus :</p>
<ol class="arabic">
<li><p>Start up the base environment by changing to the bash shell.
It will look something like this</p>
<blockquote>
<div><p><em>(base)username&#64;host:</em></p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The prompt may vary, based on how the sys admin set up the account.</p>
</div>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic" start="2">
<li><p>Activate the environment.  From the (base) prompt, enter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conda activate name-of-env</span>
</pre></div>
</div>
<p>where <strong>name-of-env</strong> is found at the top of the environment.yml file</p>
<blockquote>
<div><p>e.g. <em>mini3.6.3</em></p>
</div></blockquote>
<p>Another way to find the name of the conda env is to enter the following:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conda env list</span>
</pre></div>
</div>
<p>to get a list of all the available conda envs.</p>
</li>
</ol>
</div>
<div class="section" id="optional-checking-for-missing-packages-and-mismatched-version">
<h2><span class="section-number">4.5. </span>Optional: Checking for missing packages and mismatched version<a class="headerlink" href="#optional-checking-for-missing-packages-and-mismatched-version" title="Permalink to this headline">¶</a></h2>
<p>To check for missing and mismatched packages run the check_python.py script
in the METplus directory:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">python check_python.py</span>
</pre></div>
</div>
<p>The results are sent to stdout (screen) and three files are created:</p>
<blockquote>
<div><ul class="simple">
<li><p>actual.txt:</p>
<ul>
<li><p>A list of Python packages that are on the host system</p></li>
</ul>
</li>
<li><p>missing_packages.txt:</p>
<ul>
<li><p>A list of Python packages needed for METplus but not found on the
host system</p></li>
</ul>
</li>
<li><p>mismatched.txt:</p>
<ul>
<li><p>A list of Python packages on the host system but with different
version than what is used by METplus</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deprecation.html" class="btn btn-neutral float-right" title="5. Deprecating an Old Config Variable" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="create_wrapper.html" class="btn btn-neutral" title="3. How to Create Your Own Wrapper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR/NCAR, NOAA, CSU/CIRA, and CU/CIRES.
      Last updated on Jan 27, 2021, 11:06:03 AM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>